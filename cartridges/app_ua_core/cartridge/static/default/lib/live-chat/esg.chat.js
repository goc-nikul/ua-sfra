/* jshint ignore:start */
var esg={chat:{defaults:{launch:"",landing:"",toggle:null,noCookiesWindowName:"Chat",width:"420px",height:"440px",chatMinimizedIconPath:"images/chat.svg",chatMinimizedIconWhitePath:"images/chat_white.svg",jqueryDialogEnabled:!1},_chatModal:null,_chatModalMinizmied:null,_chatModalMinizmiedUnread:null,_chatLaunchIframe:null,_chatLandingIframe:null,_origPageTitle:document.title,_chatLaunchIframeLoaded:!1,_chatLandingIframeLoaded:!1,_chatToggleClicked:!1,_currIframeTarget:null,_totalChatMessageCount:0,_chatLockRefreshIntervalID:null,_esgChatLockTitle:"LIVE CHAT",_esgChatLockMsg:"It looks like you already have a chat session open in another window. Please go back to your original chat session so our teammate can continue helping you.",init:function(options){esg.chat.options=esg.extend(esg.chat.defaults,options);if(esg.cookiesEnabled()){window.onfocus=function(e){if(esg.chat.windowHasChatLock()&&!esg.chat.isMinimized()){esg.chat.setChatMsgCnt(esg.chat.getChatMsgCnt("total"),"read");esg.chat.updatePageTitle()}};window.addEventListener("message",function(e){try{var msgData=JSON.parse(e.data);esg.chat.handleMsgFromIframe(msgData)}catch(e){}})}
if(esg.chat.options.toggle!=null){if(esg.chat.options.toggle!=""){var toggles=document.getElementsByClassName(esg.chat.options.toggle);for(var i=0;i<toggles.length;i++){var toggle=toggles[i];if(toggle)toggle.addEventListener("click",function(e){if(esg.cookiesEnabled()&&esg.chat.isChatSessionActive()&&!esg.chat.windowCanObtainChatLock()){esg.chat.showChatLockActionDialog();return}else if(esg.cookiesEnabled()&&esg.chat.isChatSessionActive()&&!esg.chat.windowHasChatLock()&&esg.chat.windowCanObtainChatLock()){esg.setCookie("esg.chat.status","CHAT-DISCONNECTED",60);esg.setCookie("esg.chat.minimized",!1,60);esg.setCookie("esg.chat.readChatMsgCnt",0,60)}else if(esg.cookiesEnabled()&&esg.chat.isChatSessionActive()&&esg.chat.windowHasChatLock()){esg.chat.showChatLockActionDialog();return}
if(esg.cookiesEnabled()){if(!esg.chat.obtainChatLockForWindow()){esg.chat.showChatLockActionDialog();return}}
if(esg.cookiesEnabled()){esg.chat.initChatModal();esg.chat.initChatLaunchMinimizedModals();esg.chat._chatToggleClicked=!0;if(esg.chat.isMinimized()){esg.chat.displayChatModalMinimized()}else{if(esg.chat._chatLaunchIframeLoaded){esg.chat.displayChatModal()}else{esg.chat.displayChatModalMinimized()}}}else{esg.chat.displayChatModal()}
e.preventDefault()})}}}
if(esg.cookiesEnabled()&&esg.chat.isChatSessionActive()&&esg.chat.windowHasChatLock()){esg.chat.obtainChatLockForWindow();esg.chat.initChatModal();esg.chat.initChatLaunchMinimizedModals();if(esg.chat.isMinimized()){esg.chat.displayChatModalMinimized()}else{if(esg.chat._chatLandingIframeLoaded){esg.chat.displayChatModal()}else{esg.chat.displayChatModalMinimized()}}}
if(esg.cookiesEnabled()&&!esg.chat.isChatSessionActive()&&esg.chat.windowHasChatLock()){esg.chat.releaseChatLockForWindow()}},showChatLockActionDialog:function(){esg.showModalDialog(esg.chat._esgChatLockTitle,esg.chat._esgChatLockMsg)},toggleParentScrollingOnMobile:function(disableOrEnable){if(!window.esgflags||!window.esgflags.isMobile)return;try{if(disableOrEnable=="disable"){var vpH=window.innerHeight;esg.chat.origHtmlHt=document.documentElement.style.height;esg.chat.origBodyHt=document.body.style.height;document.documentElement.style.height=vpH.toString()+"px";document.body.style.height=vpH.toString()+"px";document.body.style.overflow="hidden";document.body.style.position="fixed"}else{if(esg.chat.origHtmlHt)document.documentElement.style.height=esg.chat.origHtmlHt+"px";if(esg.chat.origBodyHt)document.body.style.height=esg.chat.origBodyHt+"px";document.body.style.overflow="auto";document.body.style.position="static"}}catch(e){}},obtainChatLockForWindow:function(){if(!esg.chat.windowCanObtainChatLock())return!1;var existingLockID=esg.getCookie("esg.chat.chatlockid"),lockID="dca81088-b71b-43ff-8255-8017c54389ae",cookieDurationInMin=0.5;if(existingLockID==""){window.clearInterval(esg.chat._chatLockRefreshIntervalID);esg.chat._chatLockRefreshIntervalID=null;esg.setCookie("esg.chat.chatlockid",lockID,cookieDurationInMin);window.name=lockID}
if(esg.chat._chatLockRefreshIntervalID==null){esg.chat._chatLockRefreshIntervalID=setInterval(function(){var lockID="dca81088-b71b-43ff-8255-8017c54389ae",cookieDurationInMin=0.5;esg.setCookie("esg.chat.chatlockid",lockID,cookieDurationInMin)},(cookieDurationInMin*60*1000)/10)}
return!0},releaseChatLockForWindow:function(){window.clearInterval(esg.chat._chatLockRefreshIntervalID);esg.setCookie("esg.chat.chatlockid","",0);window.name="";esg.chat._chatLockRefreshIntervalID=null},windowHasChatLock:function(){var lockID=esg.getCookie("esg.chat.chatlockid");return lockID!=""&&window.name==lockID},windowCanObtainChatLock:function(){var lockID=esg.getCookie("esg.chat.chatlockid");return lockID==""||(lockID!=""&&window.name==lockID)},translateToChatLandingURLParamString:function(postDataForChatLanding){var urlParamString="",paramMap={"Contact_Name_First":"Contact.Name.First","Contact_Name_Last":"Contact.Name.Last","Contact_Emails_PRIMARY_Address":"Contact.Email.0.Address","Incident_Product":"p","Incident_Category":"c","Incident_Subject":"Incident.Subject","chat_data":"chat_data",};for(key in postDataForChatLanding){if(paramMap[key]!=null){urlParamString+="/"+paramMap[key]+"/"+postDataForChatLanding[key]}}
return urlParamString},handleMsgFromIframe:function(msgData){if(msgData.msgType==null)return;switch(msgData.msgType){case "chat-modal-refocused":if(!esg.chat.windowHasChatLock())return;if(esg.chat.windowHasChatLock()&&!esg.chat.isMinimized()){esg.chat.setChatMsgCnt(esg.chat.getChatMsgCnt("total"),"read");esg.chat.updatePageTitle()}
break;case "chat-status":if(!esg.chat.windowHasChatLock())return;if(msgData.message=="CHAT-CONNECTED"&&!esg.chat.isMinimized()&&esg.chat.windowHasChatLock()&&!esg.chat.isChatModalVisibleAndExpanded()){esg.chat.playIframeAnimation("showChat")}
if(msgData.message=="CHAT-DISCONNECTED"){esg.chat.setChatMsgCnt(0,"total");esg.chat.setChatMsgCnt(0,"read")}
if(msgData.message=="CHAT-CANCELLED"){esg.chat.hide();esg.chat.releaseChatLockForWindow()}
esg.setCookie("esg.chat.status",msgData.message,60);if(typeof msgData.postDataForChatLanding=="object"&&JSON.stringify(msgData.postDataForChatLanding)!="{}"&&JSON.stringify(msgData.postDataForChatLanding)!="[]"){esg.setCookie("esg.chat.chatLandingParamString",esg.chat.translateToChatLandingURLParamString(msgData.postDataForChatLanding),60)}
break;case "chat-message-received":if(!esg.chat.windowHasChatLock())return;esg.chat.incChatMsgCnt("total");if(!esg.chat.isMinimized()&&document.hasFocus()){esg.chat.incChatMsgCnt("read")}else{if(esg.chat.isMinimized()){esg.chat.displayChatModalMinimized()}
esg.chat.updatePageTitle()}
break;case "iframe-control-command":if(!esg.chat.windowHasChatLock())return;switch(msgData.command){case "MAXIMIZE":esg.chat.playIframeAnimation("showChat");break;case "MINIMIZE":esg.chat.playIframeAnimation("hideChat");break;case "CLOSE":esg.chat.hide();esg.chat.releaseChatLockForWindow();break}
break;case "chat-launch-loaded":esg.chat._currIframeTarget="chat_launch";if(!esg.chat.isChatSessionActive()&&esg.chat._chatToggleClicked&&!esg.chat.isMinimized()&&esg.chat.windowHasChatLock()){esg.chat.playIframeAnimation("showChat")}
esg.chat._chatLaunchIframeLoaded=!0;break;case "chat-landing-loaded":esg.chat._currIframeTarget="chat_landing";if(esg.chat.isChatSessionActive()&&!esg.chat.isMinimized()&&esg.chat.windowHasChatLock()&&esg.chat.isChatWaiting()){esg.chat.playIframeAnimation("showChat")}
esg.chat._chatLandingIframeLoaded=!0;break}},updatePageTitle:function(){var unreadCnt=esg.chat.getChatMsgCnt("unread");if(unreadCnt>0){document.title="("+unreadCnt+") "+esg.chat._origPageTitle}else{document.title=esg.chat._origPageTitle}},playIframeAnimation:function(animation){switch(animation){case "showChat":case "hideChat":esg.chat.setChatMsgCnt(esg.chat.getChatMsgCnt("total"),"read");esg.chat.updatePageTitle();if(animation=="showChat"){esg.chat.setChatModalMinimizedFlag(!1);esg.chat.displayChatModal();esg.chat.hideMinimizedChatModals()}else{esg.chat.setChatModalMinimizedFlag(!0)}
var height=parseInt(esg.chat._chatModal.clientHeight),initialMargin=animation=="showChat"?-height:0,frameCnt=24,duration=300,fpms=frameCnt/duration,periodInMs=1/fpms,deltaPerFrame=height/frameCnt,reqid=esg.setAnimationInterval(frame,periodInMs);if(animation=="showChat"){esg.chat._chatModal.style.marginBottom=-height+"px"}else{esg.chat._chatModal.style.marginBottom="0px"}
function frame(){if(animation=="showChat"){if(parseInt(esg.chat._chatModal.style.marginBottom)>=0){esg.chat._chatModal.style.marginBottom="0px";esg.clearAnimationInterval(reqid);return!1}else{esg.chat._chatModal.style.marginBottom=(parseInt(esg.chat._chatModal.style.marginBottom)+deltaPerFrame)+"px"}}else{if(parseInt(esg.chat._chatModal.style.marginBottom)<=-height){esg.chat._chatModal.style.marginBottom=-height+"px";esg.chat.hide();esg.chat.displayChatModalMinimized();esg.clearAnimationInterval(reqid);return!1}else{esg.chat._chatModal.style.marginBottom=(parseInt(esg.chat._chatModal.style.marginBottom)-deltaPerFrame)+"px"}}}
break}},setChatMsgCnt:function(count,whichCount){if(whichCount==null)whichCount="total";if(count===parseInt(count,10)){switch(whichCount){case "total":esg.chat._totalChatMessageCount=count;break;case "read":esg.setCookie("esg.chat.readChatMsgCnt",parseInt(count,10),60);break;default:throw "Attempt to set unknown chat message count."}}else{console.log("setChatMsgCnt called with non-integer parameter.")}},incChatMsgCnt:function(whichCount){if(whichCount==null)whichCount="total";switch(whichCount){case "total":esg.chat._totalChatMessageCount++;break;case "read":var readCnt=esg.getCookie("esg.chat.readChatMsgCnt");if(readCnt!=""){try{readCnt=parseInt(readCnt)}catch(e){console.log("Error encountered trying to parse read chat message count: ".e.message)}
readCnt++;esg.chat.setChatMsgCnt(readCnt,"read")}else{readCnt=1;esg.chat.setChatMsgCnt(readCnt,"read")}
break;default:throw "Attempt to increment unknown chat message count."}},getChatMsgCnt:function(whichCount){if(whichCount==null)whichCount="total";switch(whichCount){case "total":return esg.chat._totalChatMessageCount;break;case "read":var readCnt=esg.getCookie("esg.chat.readChatMsgCnt");if(readCnt!=""){try{readCnt=parseInt(readCnt)}catch(e){console.log("Error encountered trying to parse read chat message count: ".e.message);return 0}
return readCnt}else{return 0}
break;case "unread":var readCnt=esg.getCookie("esg.chat.readChatMsgCnt");if(readCnt!=""){try{readCnt=parseInt(readCnt)}catch(e){console.log("Error encountered trying to parse read chat message count: ".e.message);return esg.chat._totalChatMessageCount}
return Math.max(esg.chat._totalChatMessageCount-readCnt,0)}else{return esg.chat._totalChatMessageCount}
break;default:throw "Attempt to get unknown chat message count."}},setChatModalMinimizedFlag:function(isMinimized){if(typeof(isMinimized)!=="boolean"){console.log("setChatModalMinimizedFlag called with non-boolean parameter.");return}
esg.setCookie("esg.chat.minimized",isMinimized,60)},isMinimized:function(){var isMinimizedCookieVal=esg.getCookie("esg.chat.minimized");return isMinimizedCookieVal==="true"?!0:!1},isChatConnected:function(){return esg.getCookie("esg.chat.status")=="CHAT-CONNECTED"},isChatWaiting:function(){return esg.getCookie("esg.chat.status")=="CHAT-WAITING"},isChatSessionActive:function(){switch(esg.getCookie("esg.chat.status")){case "CHAT-WAITING":return!0;case "CHAT-CONNECTED":return!0}
return!1},initChatModal:function(){var paramString=esg.getCookie("esg.chat.chatLandingParamString");if(esg.chat._chatModal==null){esg.chat._chatModal=document.createElement("div");esg.chat._chatModal.id="esg-chat-modal";esg.chat._chatModal.style.display="none";esg.chat._chatModal.className="esg-chat-modal";var iframe=document.createElement("iframe");iframe.id="esg-chat-modal-iframe";iframe.src=esg.chat.isChatSessionActive()&&esg.chat.windowHasChatLock()?esg.chat.options.landing+paramString:esg.chat.options.launch;iframe.className="esg-chat-modal-iframe";esg.chat._currIframeTarget=esg.chat.isChatSessionActive()?"chat_landing":"chat_launch";esg.chat._chatModal.appendChild(iframe);document.body.appendChild(esg.chat._chatModal)}else{var children=esg.chat._chatModal.childNodes;for(var i=0;i<children.length;i++){var currChild=children[i];if(currChild.id=="esg-chat-modal-iframe"){var newSrc=esg.chat.isChatSessionActive()?esg.chat.options.landing+paramString:esg.chat.options.launch,newTarget=esg.chat.isChatSessionActive()?"chat_landing":"chat_launch";if(newTarget!=esg.chat._currIframeTarget){esg.chat.hide();if(newSrc==esg.chat.options.landing){esg.chat._chatLandingIframeLoaded=!1}else{esg.chat._chatLaunchIframeLoaded=!1}
currChild.src=newSrc;esg.chat._currIframeTarget=newTarget}}}}},displayChatModal:function(){if(esg.cookiesEnabled()){esg.chat.toggleParentScrollingOnMobile("disable");esg.show(esg.chat._chatModal)}else{var newWindowFeatureString="menubar=no,location=no,resizable=no,scrollbars=no,status=no,width="+esg.chat.options.width+",height="+esg.chat.options.height,newWindow=window.open(esg.chat.options.launch,esg.chat.options.noCookiesWindowName,newWindowFeatureString)}},initChatLaunchMinimizedModals:function(){var modals=["read","unread"];for(var i=0;i<modals.length;i++){currModal=modals[i];var modal=document.createElement("div");modal.style.display="none";modal.className=currModal=="read"?"esg-chat-modal-minimized":"esg-chat-modal-minimized-unread";var icon=document.createElement("img");icon.src=currModal=="read"?esg.chat.options.chatMinimizedIconPath:esg.chat.options.chatMinimizedIconWhitePath;icon.className="esg-chat-modal-minimized-icon";var text=document.createElement("div");text.innerHTML="LIVE CHAT";text.className="esg-chat-modal-minimized-text";modal.appendChild(icon);if(currModal=="unread"){var icon2=document.createElement("img");icon2.src=esg.chat.options.chatMinimizedIconPath;icon2.className="esg-chat-modal-minimized-icon2";modal.appendChild(icon2)}
modal.appendChild(text);if(currModal=="unread"){var msgCount=document.createElement("div");msgCount.id="esg-chat-modal-minimized-unread-msg-count";msgCount.innerHTML="(0)";msgCount.className="esg-chat-modal-minimized-unread-msg-count";modal.appendChild(msgCount)}
modal.addEventListener("click",function(e){if((esg.chat.isChatSessionActive()&&esg.chat._chatLandingIframeLoaded)||(!esg.chat.isChatSessionActive()&&esg.chat._chatLaunchIframeLoaded)||(!esg.chat.isChatSessionActive()&&esg.chat._currIframeTarget=="chat_landing"&&esg.chat._chatLandingIframeLoaded)){esg.chat.playIframeAnimation("showChat")}
e.preventDefault()});document.body.appendChild(modal);if(currModal=="read"){esg.chat._chatModalMinizmied=modal}else{esg.chat._chatModalMinizmiedUnread=modal}
if(currModal=="unread"){var periodInMs=1000,reqid=esg.setAnimationInterval(frame,periodInMs);function frame(){if(esg.chat._chatModalMinizmiedUnread.style.display!="none"){esg.chat._chatModalMinizmiedUnread.className=esg.chat._chatModalMinizmiedUnread.className=="esg-chat-modal-minimized-unread-flash"?"esg-chat-modal-minimized-unread":"esg-chat-modal-minimized-unread-flash"}}}}},displayChatModalMinimized:function(){var unreadMsgCnt=esg.chat.getChatMsgCnt("unread");var currMinimizedModal=unreadMsgCnt==0?esg.chat._chatModalMinizmied:esg.chat._chatModalMinizmiedUnread;if(unreadMsgCnt!=0){var msgCount=document.getElementById("esg-chat-modal-minimized-unread-msg-count");if(msgCount!=null){msgCount.innerHTML="("+unreadMsgCnt+")"}}
var otherMinimizedModal=unreadMsgCnt==0?esg.chat._chatModalMinizmiedUnread:esg.chat._chatModalMinizmied;esg.hide(otherMinimizedModal);esg.show(currMinimizedModal)},hide:function(){esg.chat.toggleParentScrollingOnMobile("enable");esg.hide(esg.chat._chatModal)},hideMinimizedChatModals:function(){esg.hide(esg.chat._chatModalMinizmied);esg.hide(esg.chat._chatModalMinizmiedUnread)},isChatModalVisibleAndExpanded:function(){return esg.chat._chatModal!=null&&esg.chat._chatModal.style.display!="none"}},_esgDialogCount:0,setAnimationInterval:function(animFunc,frameDurationInMs){if(!window.requestAnimationFrame){var vendors=['ms','moz','webkit','o'];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+'RequestAnimationFrame'];window.cancelAnimationFrame=window[vendors[x]+'CancelAnimationFrame']||window[vendors[x]+'CancelRequestAnimationFrame']}}
if(window.requestAnimationFrame&&window.cancelAnimationFrame){var req={id:null},lastFrameUpdate=null;function updateAnim(timestamp){if(lastFrameUpdate==null)lastFrameUpdate=timestamp;var delta=timestamp-lastFrameUpdate;var continueLoop=!0;if(delta>=frameDurationInMs){continueLoop=animFunc.call();lastFrameUpdate=timestamp}
if(continueLoop!==!1){req.id=window.requestAnimationFrame(updateAnim)}}
req.id=window.requestAnimationFrame(updateAnim);return req}else{return setInterval(animFunc,frameDurationInMs)}},clearAnimationInterval:function(reqid){if(typeof reqid=="object"){window.cancelAnimationFrame(reqid.id)}else{clearInterval(reqid)}},documentReady:function(callback,context){if(this._readyFired){setTimeout(function(){callback(context)},1);return}
else{this._readyList.push({fn:callback,ctx:context})}
if(document.readyState==="complete"){setTimeout(this._ready,1)}
else if(!this._sreadyEventHandlersInstalled){if(document.addEventListener){document.addEventListener("DOMContentLoaded",this._ready,!1);window.addEventListener("load",this._ready,!1)}
else{document.attachEvent("onreadystatechange",this._readyStateChange);window.attachEvent("onload",this._ready)}
this._readyEventHandlersInstalled=!0}},_readyList:[],_readyFired:!1,_readyEventHandlersInstalled:!1,_ready:function(){if(!this._readyFired){this._readyFired=!0;for(var i=0;i<esg._readyList.length;i++)esg._readyList[i].fn.call(window,esg._readyList[i].ctx);esg._readyList=[]}},_readyStateChange:function(){if(document.readyState==="complete")this._ready()},setCookie:function(name,value,expireMinutes){expireMinutes=expireMinutes||24*60;var d=new Date();d.setTime(d.getTime()+(expireMinutes*60*1000));var expires="expires="+d.toUTCString();document.cookie=name+"="+value+";"+expires+";path=/"},getCookie:function(name){var cname=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1);if(c.indexOf(cname)==0)return c.substring(cname.length,c.length)}
return ""},cookiesEnabled:function(){var cookieEnabled=navigator.cookieEnabled;if(!cookieEnabled){document.cookie="testcookie123";cookieEnabled=document.cookie.indexOf("testcookie123")!=-1}
return cookieEnabled},show:function(el){if(!el instanceof HTMLElement)el=document.getElementById(id);if(el)el.style.display="block"},hide:function(el){if(el==null)return;if(!el instanceof HTMLElement)el=document.getElementById(id);if(el)el.style.display="none"},extend:function(target,source){target=target||{};for(var prop in source){if(typeof source[prop]==='object'){target[prop]=esg.extend(target[prop],source[prop])}
else{target[prop]=source[prop]}}
return target},showModalDialog:function(title,message){if(esg.chat.options.jqueryDialogEnabled){var dialog=$("<div class=\"ua_ModalChatLockDialog\" title=\""+title+"\">"+message+"</div>");dialog.dialog({modal:!0})}else{window.alert(message)}}}
/* jshint ignore:end */